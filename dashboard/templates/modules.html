{% extends "base.html" %}

{% block title %}Module Management - Trading Bot{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="/static/css/modules.css">
<style>
    /* Theme-aware styles that respect dark/light mode */
    .modules-container {
        padding: 20px;
        max-width: 1400px;
        margin: 0 auto;
    }

    .modules-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid var(--border-color, #e5e7eb);
    }

    .modules-title {
        font-size: 2rem;
        font-weight: 700;
        color: var(--text-primary, #111827);
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .refresh-btn {
        background: var(--primary-color, #3b82f6);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
    }

    .refresh-btn:hover {
        background: var(--primary-hover, #2563eb);
        transform: translateY(-2px);
    }

    /* Summary Cards */
    .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .summary-card {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        transition: all 0.3s;
    }

    .summary-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
    }

    .summary-label {
        font-size: 0.875rem;
        color: var(--text-secondary);
        margin-bottom: 8px;
        font-weight: 500;
    }

    .summary-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 4px;
    }

    .summary-subtitle {
        font-size: 0.813rem;
        color: var(--text-muted);
    }

    .positive {
        color: #10b981 !important;
    }

    .negative {
        color: #ef4444 !important;
    }

    /* Capital Allocation Chart */
    .capital-section {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 30px;
    }

    .capital-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 20px;
    }

    .allocation-bar {
        display: flex;
        height: 48px;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 20px;
        border: 1px solid var(--border-color);
    }

    .allocation-segment {
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 0.875rem;
        transition: all 0.3s;
        cursor: pointer;
    }

    .allocation-segment:hover {
        filter: brightness(1.1);
    }

    .allocation-legend {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
    }

    .legend-item {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .legend-color {
        width: 16px;
        height: 16px;
        border-radius: 4px;
    }

    .legend-name {
        font-weight: 500;
        color: var(--text-primary);
    }

    .legend-amount {
        color: var(--text-secondary);
        font-size: 0.875rem;
    }

    /* Module Cards */
    .modules-grid {
        display: grid;
        gap: 24px;
    }

    .module-card {
        background: var(--bg-secondary);
        border: 2px solid var(--border-color);
        border-radius: 12px;
        padding: 24px;
        transition: all 0.3s;
    }

    .module-card.running {
        border-color: #10b981;
        box-shadow: 0 0 0 1px rgba(16, 185, 129, 0.1);
    }

    .module-card.stopped {
        border-color: #6b7280;
        opacity: 0.8;
    }

    .module-card.disabled {
        border-color: #d1d5db;
        opacity: 0.6;
    }

    .module-card.error {
        border-color: #ef4444;
        box-shadow: 0 0 0 1px rgba(239, 68, 68, 0.1);
    }

    .module-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(0,0,0,0.12);
    }

    .module-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
        padding-bottom: 16px;
        border-bottom: 1px solid var(--border-color);
    }

    .module-info {
        flex: 1;
    }

    .module-name {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 6px;
    }

    .module-type {
        font-size: 0.875rem;
        color: var(--text-secondary);
        font-weight: 500;
    }

    .module-status-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 0.813rem;
        font-weight: 600;
        text-transform: uppercase;
    }

    .status-running {
        background: rgba(16, 185, 129, 0.2);
        color: #10b981;
    }

    .status-stopped {
        background: rgba(107, 114, 128, 0.2);
        color: var(--text-secondary);
    }

    .status-disabled {
        background: rgba(107, 114, 128, 0.2);
        color: var(--text-muted);
    }

    .status-error {
        background: rgba(239, 68, 68, 0.2);
        color: #ef4444;
    }

    .status-initializing {
        background: rgba(59, 130, 246, 0.2);
        color: #3b82f6;
    }

    .status-paused {
        background: rgba(245, 158, 11, 0.2);
        color: #f59e0b;
    }

    /* Trading Mode Badges */
    .mode-badge {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 4px 10px;
        border-radius: 6px;
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-left: 8px;
    }

    .mode-dry-run {
        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        color: white;
        box-shadow: 0 2px 4px rgba(59, 130, 246, 0.3);
    }

    .mode-live {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        color: white;
        box-shadow: 0 2px 4px rgba(239, 68, 68, 0.3);
        animation: pulse-live 2s ease-in-out infinite;
    }

    .mode-testnet {
        background: linear-gradient(135deg, #f59e0b, #d97706);
        color: white;
        box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3);
    }

    @keyframes pulse-live {
        0%, 100% { box-shadow: 0 2px 4px rgba(239, 68, 68, 0.3); }
        50% { box-shadow: 0 2px 12px rgba(239, 68, 68, 0.6); }
    }

    /* Health Status Badge */
    .health-badge {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.688rem;
        font-weight: 600;
        margin-left: 8px;
    }

    .health-healthy {
        background: rgba(16, 185, 129, 0.15);
        color: #10b981;
    }

    .health-degraded {
        background: rgba(245, 158, 11, 0.15);
        color: #f59e0b;
    }

    .health-unhealthy {
        background: rgba(239, 68, 68, 0.15);
        color: #ef4444;
    }

    /* Risk Level Indicator */
    .risk-indicator {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.688rem;
        font-weight: 600;
    }

    .risk-low {
        background: rgba(16, 185, 129, 0.15);
        color: #10b981;
    }

    .risk-medium {
        background: rgba(245, 158, 11, 0.15);
        color: #f59e0b;
    }

    .risk-high {
        background: rgba(239, 68, 68, 0.15);
        color: #ef4444;
    }

    /* Security Warning Banner */
    .security-warning {
        background: linear-gradient(135deg, #fef3c7, #fde68a);
        border: 1px solid #f59e0b;
        border-radius: 8px;
        padding: 12px 16px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 12px;
        color: #92400e;
    }

    .security-warning i {
        font-size: 1.25rem;
        color: #f59e0b;
    }

    .security-warning-text {
        flex: 1;
    }

    .security-warning-title {
        font-weight: 700;
        margin-bottom: 2px;
    }

    .security-warning-detail {
        font-size: 0.875rem;
        opacity: 0.9;
    }

    /* Module Metrics Grid */
    .module-metrics {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 16px;
        margin-bottom: 20px;
    }

    .metric-item {
        background: var(--bg-tertiary);
        padding: 14px;
        border-radius: 8px;
        border: 1px solid var(--border-color);
    }

    .metric-label {
        font-size: 0.75rem;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 6px;
        font-weight: 600;
    }

    .metric-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 4px;
    }

    .metric-subtitle {
        font-size: 0.75rem;
        color: var(--text-muted);
    }

    /* Module Actions */
    .module-actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }

    .action-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        gap: 6px;
    }

    .action-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .btn-enable {
        background: #10b981;
        color: white;
    }

    .btn-enable:hover {
        background: #059669;
    }

    .btn-disable {
        background: #ef4444;
        color: white;
    }

    .btn-disable:hover {
        background: #dc2626;
    }

    .btn-pause {
        background: #f59e0b;
        color: white;
    }

    .btn-pause:hover {
        background: #d97706;
    }

    .btn-configure {
        background: #3b82f6;
        color: white;
    }

    .btn-configure:hover {
        background: #2563eb;
    }

    .btn-details {
        background: #8b5cf6;
        color: white;
    }

    .btn-details:hover {
        background: #7c3aed;
    }

    /* Error Message */
    .error-message {
        margin-top: 16px;
        padding: 12px;
        background: #fef2f2;
        border: 1px solid #fecaca;
        border-radius: 8px;
        color: #991b1b;
        font-size: 0.875rem;
        display: flex;
        align-items: start;
        gap: 8px;
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 60px 20px;
        background: var(--bg-secondary);
        border: 2px dashed var(--border-color);
        border-radius: 12px;
    }

    .empty-icon {
        font-size: 4rem;
        margin-bottom: 16px;
    }

    .empty-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 8px;
    }

    .empty-text {
        color: var(--text-secondary);
    }

    /* Loading Spinner */
    .loading-spinner {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(59, 130, 246, 0.3);
        border-radius: 50%;
        border-top-color: #3b82f6;
        animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
        to { transform: rotate(360deg); }
    }

    /* Error message styling for dark theme */
    .error-message {
        background: rgba(239, 68, 68, 0.1);
        border-color: rgba(239, 68, 68, 0.3);
        color: #ef4444;
    }
</style>
{% endblock %}

{% block content %}
<div class="modules-container">
    <!-- Header -->
    <div class="modules-header">
        <div class="modules-title">
            <i class="fas fa-cubes"></i>
            Module Management
        </div>
        <button class="refresh-btn" onclick="refreshModules()">
            <i class="fas fa-sync-alt"></i> Refresh
        </button>
    </div>

    <!-- Summary Statistics -->
    <div class="summary-grid">
        <div class="summary-card">
            <div class="summary-label">Total Capital</div>
            <div class="summary-value" id="totalCapital">${{ metrics.total_capital|default(1400)|round(2) }}</div>
            <div class="summary-subtitle">Available: ${{ metrics.available_capital|default(200)|round(2) }}</div>
        </div>

        <div class="summary-card">
            <div class="summary-label">Allocated Capital</div>
            <div class="summary-value" id="allocatedCapital">${{ metrics.allocated_capital|default(1200)|round(2) }}</div>
            <div class="summary-subtitle">
                {{ ((metrics.allocated_capital|default(1200) / metrics.total_capital|default(1400)) * 100)|round(1) }}% of total
            </div>
        </div>

        <div class="summary-card">
            <div class="summary-label">Active Modules</div>
            <div class="summary-value" id="activeModules">
                {{ metrics.active_modules|default(1) }}<span style="font-size: 1.5rem; color: var(--text-secondary);">/{{ modules|length|default(3) }}</span>
            </div>
            <div class="summary-subtitle">{{ modules|length|default(3) }} modules registered</div>
        </div>

        <div class="summary-card">
            <div class="summary-label">Total P&L</div>
            <div class="summary-value {% if metrics.total_pnl|default(0) >= 0 %}positive{% else %}negative{% endif %}" id="totalPnl">
                ${{ metrics.total_pnl|default(0)|round(2) }}
            </div>
            <div class="summary-subtitle {% if metrics.total_pnl|default(0) >= 0 %}positive{% else %}negative{% endif %}">
                {{ ((metrics.total_pnl|default(0) / metrics.total_capital|default(1)) * 100)|round(2) }}% ROI
            </div>
        </div>
    </div>

    <!-- Capital Allocation Chart -->
    <div class="capital-section">
        <div class="capital-title">Capital Allocation</div>
        <div class="allocation-bar">
            {% if modules %}
                {% set colors = ['#667eea', '#f093fb', '#4facfe', '#43e97b', '#fa709a', '#fee140'] %}
                {% for module in modules %}
                    {% if module.config.capital_allocation > 0 %}
                    <div class="allocation-segment"
                         style="width: {{ (module.config.capital_allocation / metrics.total_capital * 100)|round(1) }}%;
                                background: {{ colors[loop.index0 % colors|length] }};"
                         title="{{ module.name }}: ${{ module.config.capital_allocation }}">
                        {% if (module.config.capital_allocation / metrics.total_capital * 100) > 8 %}
                            ${{ module.config.capital_allocation|round(0) }}
                        {% endif %}
                    </div>
                    {% endif %}
                {% endfor %}
                {% if metrics.available_capital > 0 %}
                <div class="allocation-segment"
                     style="width: {{ (metrics.available_capital / metrics.total_capital * 100)|round(1) }}%;
                            background: #e0e0e0; color: #555;"
                     title="Available: ${{ metrics.available_capital }}">
                    {% if (metrics.available_capital / metrics.total_capital * 100) > 8 %}
                        Available
                    {% endif %}
                </div>
                {% endif %}
            {% endif %}
        </div>

        <div class="allocation-legend">
            {% if modules %}
                {% set colors = ['#667eea', '#f093fb', '#4facfe', '#43e97b', '#fa709a', '#fee140'] %}
                {% for module in modules %}
                <div class="legend-item">
                    <div class="legend-color" style="background: {{ colors[loop.index0 % colors|length] }};"></div>
                    <div>
                        <div class="legend-name">{{ module.name|title }}</div>
                        <div class="legend-amount">${{ module.config.capital_allocation|round(0) }} ({{ (module.config.capital_allocation / metrics.total_capital * 100)|round(1) }}%)</div>
                    </div>
                </div>
                {% endfor %}
                <div class="legend-item">
                    <div class="legend-color" style="background: #e0e0e0;"></div>
                    <div>
                        <div class="legend-name">Available</div>
                        <div class="legend-amount">${{ metrics.available_capital|round(0) }} ({{ (metrics.available_capital / metrics.total_capital * 100)|round(1) }}%)</div>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Security/Auth Warning Banner (if applicable) -->
    {% if warnings %}
    <div class="security-warning">
        <i class="fas fa-exclamation-triangle"></i>
        <div class="security-warning-text">
            <div class="security-warning-title">Security Notice</div>
            <div class="security-warning-detail">
                {% for warning in warnings %}
                    {{ warning }}{% if not loop.last %}<br>{% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Module Cards -->
    <div class="modules-grid">
        {% if modules %}
            {% for module in modules %}
            <div class="module-card {{ module.status }}" id="module-{{ module.name }}">
                <div class="module-header">
                    <div class="module-info">
                        <div class="module-name">
                            {{ module.name|title|replace('_', ' ') }}
                            <!-- Trading Mode Badge -->
                            {% if module.health.dry_run is defined %}
                                {% if module.health.dry_run %}
                                    <span class="mode-badge mode-dry-run">
                                        <i class="fas fa-flask"></i> DRY RUN
                                    </span>
                                {% elif module.health.testnet is defined and module.health.testnet %}
                                    <span class="mode-badge mode-testnet">
                                        <i class="fas fa-vial"></i> TESTNET
                                    </span>
                                {% else %}
                                    <span class="mode-badge mode-live">
                                        <i class="fas fa-broadcast-tower"></i> LIVE
                                    </span>
                                {% endif %}
                            {% endif %}
                        </div>
                        <div class="module-type">
                            <i class="fas fa-{{ 'cube' if module.module_type == 'dex_trading' else 'chart-line' if module.module_type == 'futures_trading' else 'coins' }}"></i>
                            {{ module.module_type|title|replace('_', ' ') }}
                            <!-- Health Status -->
                            {% if module.health.status is defined %}
                                <span class="health-badge health-{{ module.health.status }}">
                                    <i class="fas fa-{{ 'check-circle' if module.health.status == 'healthy' else 'exclamation-circle' if module.health.status == 'degraded' else 'times-circle' }}"></i>
                                    {{ module.health.status|title }}
                                </span>
                            {% endif %}
                            <!-- Risk Level -->
                            {% if module.health.risk_level is defined %}
                                <span class="risk-indicator risk-{{ module.health.risk_level|lower }}">
                                    <i class="fas fa-shield-alt"></i> {{ module.health.risk_level }}
                                </span>
                            {% endif %}
                        </div>
                    </div>
                    <span class="module-status-badge status-{{ module.status }}">
                        <span class="status-dot"></span>
                        {{ module.status|upper }}
                    </span>
                </div>

                <div class="module-metrics">
                    <div class="metric-item">
                        <div class="metric-label">Capital</div>
                        <div class="metric-value">${{ module.metrics.capital_allocated|round(0) }}</div>
                        <div class="metric-subtitle">Used: ${{ module.metrics.capital_used|round(0) }}</div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-label">Positions</div>
                        <div class="metric-value">{{ module.metrics.active_positions }}</div>
                        <div class="metric-subtitle">Max: {{ module.config.max_positions }}</div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-label">Total Trades</div>
                        <div class="metric-value">{{ module.metrics.total_trades }}</div>
                        <div class="metric-subtitle">
                            Win Rate: {{ (module.metrics.win_rate * 100)|round(1) }}%
                        </div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-label">P&L</div>
                        <div class="metric-value {% if module.metrics.total_pnl >= 0 %}positive{% else %}negative{% endif %}">
                            ${{ module.metrics.total_pnl|round(2) }}
                        </div>
                        <div class="metric-subtitle {% if module.metrics.total_pnl >= 0 %}positive{% else %}negative{% endif %}">
                            {{ ((module.metrics.total_pnl / module.metrics.capital_allocated * 100)|round(2)) if module.metrics.capital_allocated > 0 else 0 }}%
                        </div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-label">Uptime</div>
                        <div class="metric-value">{{ (module.metrics.uptime_seconds / 3600)|round(1) }}h</div>
                        <div class="metric-subtitle">Errors: {{ module.metrics.errors_count }}</div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-label">Sharpe</div>
                        <div class="metric-value">{{ module.metrics.sharpe_ratio|round(2) }}</div>
                        <div class="metric-subtitle">Max DD: {{ (module.metrics.max_drawdown * 100)|round(1) }}%</div>
                    </div>
                </div>

                <div class="module-actions">
                    {% if module.enabled %}
                        {% if module.status == 'running' %}
                            <button class="action-btn btn-pause" onclick="pauseModule('{{ module.name }}')">
                                <i class="fas fa-pause"></i> Pause
                            </button>
                        {% elif module.status in ['paused', 'stopped'] %}
                            <button class="action-btn btn-enable" onclick="startModule('{{ module.name }}')">
                                <i class="fas fa-play"></i> Start
                            </button>
                        {% endif %}
                        <button class="action-btn btn-disable" onclick="disableModule('{{ module.name }}')">
                            <i class="fas fa-stop-circle"></i> Disable
                        </button>
                    {% else %}
                        <button class="action-btn btn-enable" onclick="enableModule('{{ module.name }}')">
                            <i class="fas fa-check-circle"></i> Enable
                        </button>
                    {% endif %}
                    <button class="action-btn btn-configure" onclick="configureModule('{{ module.name }}')">
                        <i class="fas fa-cog"></i> Configure
                    </button>
                    <button class="action-btn btn-details" onclick="viewModuleDetails('{{ module.name }}')">
                        <i class="fas fa-chart-bar"></i> Details
                    </button>
                </div>

                {% if module.error_message %}
                <div class="error-message">
                    <i class="fas fa-exclamation-triangle"></i>
                    <div>
                        <strong>Error:</strong> {{ module.error_message }}
                    </div>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        {% else %}
            <div class="empty-state">
                <div class="empty-icon">ðŸ“¦</div>
                <div class="empty-title">No Modules Found</div>
                <div class="empty-text">No trading modules are currently registered. Please check the system configuration.</div>
            </div>
        {% endif %}
    </div>
</div>

<script>
function refreshModules() {
    location.reload();
}

async function pauseModule(moduleName) {
    try {
        const response = await fetch(`/api/modules/${moduleName}/pause`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
        });
        if (response.ok) {
            showToast('Module paused successfully', 'success');
            setTimeout(() => location.reload(), 1000);
        } else {
            const error = await response.json();
            showToast('Failed to pause module: ' + error.detail, 'error');
        }
    } catch (error) {
        showToast('Error: ' + error.message, 'error');
    }
}

async function startModule(moduleName) {
    try {
        const response = await fetch(`/api/modules/${moduleName}/start`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
        });
        if (response.ok) {
            showToast('Module started successfully', 'success');
            setTimeout(() => location.reload(), 1000);
        } else {
            const error = await response.json();
            showToast('Failed to start module: ' + error.detail, 'error');
        }
    } catch (error) {
        showToast('Error: ' + error.message, 'error');
    }
}

async function enableModule(moduleName) {
    try {
        const response = await fetch(`/api/modules/${moduleName}/enable`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
        });
        if (response.ok) {
            showToast('Module enabled successfully', 'success');
            setTimeout(() => location.reload(), 1000);
        } else {
            const error = await response.json();
            showToast('Failed to enable module: ' + error.detail, 'error');
        }
    } catch (error) {
        showToast('Error: ' + error.message, 'error');
    }
}

async function disableModule(moduleName) {
    if (!confirm(`Are you sure you want to disable ${moduleName}? This will stop all active trading.`)) {
        return;
    }
    try {
        const response = await fetch(`/api/modules/${moduleName}/disable`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
        });
        if (response.ok) {
            showToast('Module disabled successfully', 'success');
            setTimeout(() => location.reload(), 1000);
        } else {
            const error = await response.json();
            showToast('Failed to disable module: ' + error.detail, 'error');
        }
    } catch (error) {
        showToast('Error: ' + error.message, 'error');
    }
}

function configureModule(moduleName) {
    window.location.href = `/modules/${moduleName}/configure`;
}

function viewModuleDetails(moduleName) {
    window.location.href = `/modules/${moduleName}/details`;
}

function showToast(message, type = 'info') {
    // Simple toast notification
    const toast = document.createElement('div');
    toast.className = `toast toast-${type}`;
    toast.textContent = message;
    toast.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 16px 24px;
        background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
        color: white;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 10000;
        font-weight: 600;
    `;
    document.body.appendChild(toast);
    setTimeout(() => toast.remove(), 3000);
}
</script>
{% endblock %}
