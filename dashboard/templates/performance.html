{% extends "base.html" %}

{% block title %}Performance Analytics - DexScreener Trading Bot{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Performance Analytics</h1>
    <div class="page-actions">
        <select id="performanceTimeframe" class="form-control" style="width: auto;">
            <option value="24h">24 Hours</option>
            <option value="7d" selected>7 Days</option>
            <option value="30d">30 Days</option>
            <option value="90d">90 Days</option>
            <option value="all">All Time</option>
        </select>
        <button class="btn btn-secondary" onclick="refreshPerformance()">
            <i class="fas fa-sync"></i> Refresh
        </button>
    </div>
</div>

<!-- Key Performance Metrics -->
<div class="grid grid-4">
    <div class="stat-card success">
        <i class="fas fa-dollar-sign stat-icon"></i>
        <div class="stat-label">Total Profit</div>
        <div class="stat-value" id="totalProfit">$0.00</div>
        <div class="stat-change positive" id="profitChange">
            <i class="fas fa-arrow-up"></i> 0%
        </div>
    </div>
    
    <div class="stat-card">
        <i class="fas fa-percentage stat-icon"></i>
        <div class="stat-label">ROI</div>
        <div class="stat-value" id="totalRoi">0%</div>
        <div class="stat-change" id="roiChange">All time</div>
    </div>
    
    <div class="stat-card">
        <i class="fas fa-chart-line stat-icon"></i>
        <div class="stat-label">Sharpe Ratio</div>
        <div class="stat-value" id="sharpeRatio">0.00</div>
        <div class="stat-change">Risk-adjusted</div>
    </div>
    
    <div class="stat-card warning">
        <i class="fas fa-chart-area stat-icon"></i>
        <div class="stat-label">Max Drawdown</div>
        <div class="stat-value text-danger" id="maxDrawdown">0%</div>
        <div class="stat-change">Peak to trough</div>
    </div>
</div>

<!-- Charts Row 1 -->
<div class="grid grid-2">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Equity Curve</h3>
        </div>
        <div class="card-body">
            <canvas id="equityCurveChart" height="300"></canvas>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Cumulative P&L</h3>
        </div>
        <div class="card-body">
            <canvas id="cumulativePnlChart" height="300"></canvas>
        </div>
    </div>
</div>

<!-- Trade Statistics -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">Trade Statistics</h3>
    </div>
    <div class="card-body">
        <div class="grid grid-4">
            <div>
                <div class="metric-row">
                    <span class="metric-label">Total Trades</span>
                    <span class="metric-value" id="totalTrades">0</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Winning Trades</span>
                    <span class="metric-value text-success" id="winningTrades">0</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Losing Trades</span>
                    <span class="metric-value text-danger" id="losingTrades">0</span>
                </div>
            </div>
            <div>
                <div class="metric-row">
                    <span class="metric-label">Win Rate</span>
                    <span class="metric-value" id="winRate">0%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Average Win</span>
                    <span class="metric-value text-success" id="avgWin">$0.00</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Average Loss</span>
                    <span class="metric-value text-danger" id="avgLoss">$0.00</span>
                </div>
            </div>
            <div>
                <div class="metric-row">
                    <span class="metric-label">Best Trade</span>
                    <span class="metric-value text-success" id="bestTrade">$0.00</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Worst Trade</span>
                    <span class="metric-value text-danger" id="worstTrade">$0.00</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Avg Duration</span>
                    <span class="metric-value" id="avgDuration">0h</span>
                </div>
            </div>
            <div>
                <div class="metric-row">
                    <span class="metric-label">Profit Factor</span>
                    <span class="metric-value" id="profitFactor">0.00</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Expectancy</span>
                    <span class="metric-value" id="expectancy">$0.00</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Recovery Factor</span>
                    <span class="metric-value" id="recoveryFactor">0.00</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Charts Row 2 -->
<div class="grid grid-3">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Strategy Performance</h3>
        </div>
        <div class="card-body">
            <canvas id="strategyChart" height="250"></canvas>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Win/Loss Distribution</h3>
        </div>
        <div class="card-body">
            <canvas id="winLossChart" height="250"></canvas>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Monthly Performance</h3>
        </div>
        <div class="card-body">
            <canvas id="monthlyChart" height="250"></canvas>
        </div>
    </div>
</div>

<!-- Risk Metrics -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">Risk Metrics</h3>
    </div>
    <div class="card-body">
        <div class="grid grid-3">
            <div>
                <h4>Volatility</h4>
                <div class="metric-row">
                    <span class="metric-label">Daily Volatility</span>
                    <span class="metric-value" id="dailyVol">0%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Annual Volatility</span>
                    <span class="metric-value" id="annualVol">0%</span>
                </div>
            </div>
            <div>
                <h4>Risk Ratios</h4>
                <div class="metric-row">
                    <span class="metric-label">Sharpe Ratio</span>
                    <span class="metric-value" id="sharpeRatioDetail">0.00</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Sortino Ratio</span>
                    <span class="metric-value" id="sortinoRatio">0.00</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Calmar Ratio</span>
                    <span class="metric-value" id="calmarRatio">0.00</span>
                </div>
            </div>
            <div>
                <h4>Drawdown</h4>
                <div class="metric-row">
                    <span class="metric-label">Max Drawdown</span>
                    <span class="metric-value text-danger" id="maxDrawdownDetail">0%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Avg Drawdown</span>
                    <span class="metric-value" id="avgDrawdown">0%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Recovery Time</span>
                    <span class="metric-value" id="recoveryTime">0 days</span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/performance.js"></script>
{% endblock %}